<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>WebVM - POSIX-compatible WebAssembly OS</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <script src="coi-serviceworker.min.js"></script>
    <div id="desktop">
      <!-- ターミナルウィンドウ -->
      <div
        class="window"
        id="terminal-window"
        style="top: 50px; left: 50px; width: 800px; height: 600px"
      >
        <div class="window-header">
          <div class="window-title">Terminal - WebVM</div>
          <div class="window-controls">
            <div class="window-control minimize"></div>
            <div class="window-control maximize"></div>
            <div class="window-control close"></div>
          </div>
        </div>
        <div class="window-content">
          <div class="terminal" id="terminal">
            <div id="terminal-output" class="terminal-output"></div>
            <div class="terminal-input-line">
              <span class="terminal-prompt">$ </span>
              <input
                type="text"
                id="terminal-input"
                class="terminal-input"
                autofocus
              />
              <span class="terminal-cursor"></span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      import { boot } from "../build/syslib/index.js";
      import { initializeTerminal } from "./terminal.js";
      import { initializeWindowManager } from "./window-manager.js";

      // ウィンドウマネージャーを初期化
      initializeWindowManager();

      // カーネルを起動してから ターミナルを初期化
      boot().then(() => {
        initializeTerminal();
        
        // ターミナル準備完了を通知
        if (globalThis.setTerminalReady) {
          globalThis.setTerminalReady();
        }
      });
    </script>
  </body>
</html>
